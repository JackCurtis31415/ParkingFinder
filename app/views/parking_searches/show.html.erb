
<!DOCTYPE html>
  <% place_query = Rack::Utils.escape(@parking_search.address + @parking_search.city + @parking_search.state) %>
  <% google_key = ENV['GOOGLE_MAP_KEY'] %>
<html>
  <head>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0;}
      #map-canvas {
        width: 500px;
        height: 400px;
      }
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=<%="#{google_key}"%>">
    </script>
    <script type="text/javascript">
      function initialize() {
        var myLatlng = new google.maps.LatLng(<%=@parking_search.lat%>, <%= @parking_search.lon %>);  
        var mapOptions = {
          center: myLatlng,
          zoom: 16
        };
      
        var map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);

      var contentString = '10.9';

      var infowindow = new google.maps.InfoWindow({
      content: contentString
      });
      
      var marker = new google.maps.Marker({
          position: myLatlng,
          map: map,
          animation: google.maps.Animation.DROP,
          title: 'Hello World!'
      });

      infowindow.open(map, marker);
      google.maps.event.addListener(marker, 'click', function() {
        infowindow.open(map,marker);
      });
      
      }


      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>

  <body>

  

<div class="row center">
  <h1>Parking Search</h1>

  <table>
    <tr>
      <th>Address</th>
      <th>City</th>
      <th>State</th>
      <th></th>
    </tr>

    <tr>
      <td><%= @parking_search.address %></td>
      <td><%= @parking_search.city %></td>
      <td><%= @parking_search.state %></td>
    </tr>
  </table>

  </br>
  </br>

  <h2 style="margin-top:50px">Parking Venues</h2>

  <% if @parking_venues %>
    <table>
      <tr>
        <th>Location</th>
        <th>Address</th>
        <th>City</th>
        <th>State</th>
        <th>Zip code</th>
        <th>Price</th>
        <th>Distance</th>
      </tr>

      <% @parking_venues.each_with_index do |venue, i| %>
      <tr>
        <td><%= venue.location_name %></td>
        <td><%= venue.address %></td>
        <td><%= venue.city %></td>
	<td><%= venue.state %></td>	
        <td><%= venue.zip %></td>	
        <td><%= @search_venue_sets[i].price_formated %></td>
        <td><%= (@search_venue_sets[i].distance / 5280.0).round(2) %></td>	
      </tr>
      <% end %>
    </table>
  <% end %>
  <div id="map-canvas"></div>  
  <br>
  <br>
  <%= link_to "Back", new_parking_search_path, class: :button %>
  <br>
</div>



</body>

</html>




